"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.start = start;

var _expressApp = require("./expressApp");

var _httpServer = require("./httpServer");

let server;

function start({
  config,
  dev,
  schema,
  fragmentTypes,
  webpackMiddleware
}) {
  const app = (0, _expressApp.createExpressApp)({
    dev,
    config,
    schema,
    fragmentTypes,
    webpackMiddleware
  });

  if (server) {
    server.swap(app);
    return server;
  }

  server = (0, _httpServer.createHttpServer)({
    config,
    app
  });
  server.listen(config.server.port, err => {
    if (err) {
      throw err;
    }
  });
  return server;
}